# QMIX-based Multi-Agent Reinforcement Learning for AIoT Resource Management

–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–∞—Ö Artificial Intelligence of Things (AIoT) –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ QMIX (Monotonic Value Function Factorisation for Deep Multi-Agent Reinforcement Learning).

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ qmix_aiot_implementation.py        # –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ Python
‚îú‚îÄ‚îÄ visualizations.py                  # –°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
‚îî‚îÄ‚îÄ README.md                          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install torch numpy matplotlib networkx
```

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π

```bash
python visualizations.py
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É `figs/` —Å–æ –≤—Å–µ–º–∏ –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –≤ –æ—Ç—á—ë—Ç–µ.

### 3. –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```bash
python qmix_aiot_implementation.py
```

–û–±—É—á–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç 1000 —ç–ø–∏–∑–æ–¥–æ–≤ (–ø—Ä–∏–º–µ—Ä–Ω–æ 10-15 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è).

## üìä –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

### qmix_aiot_implementation.py

#### –ö–ª–∞—Å—Å—ã:

1. **LocalQNetwork** ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è Q-—Å–µ—Ç—å —Å GRU
   - –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: obs_dim=5, action_dim=26
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: GRU(5‚Üí64) ‚Üí FC(64‚Üí128) ‚Üí FC(128‚Üí64) ‚Üí FC(64‚Üí26)

2. **QMIXMixer** ‚Äî —Å–µ—Ç—å —Å–º–µ—à–∏–≤–∞–Ω–∏—è —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç–∏
   - –ì–∏–ø–µ—Ä—Å–µ—Ç—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—Å–æ–≤
   - –§–æ—Ä–º—É–ª–∞: Q_tot = Œ£ w_i(s) * Q_i + b(s), –≥–¥–µ w_i ‚â• 0

3. **MAQLearner** ‚Äî –≥–ª–∞–≤–Ω—ã–π –∞–≥–µ–Ω—Ç –æ–±—É—á–µ–Ω–∏—è
   - –£–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ–º –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - Double DQN —Å soft update target —Å–µ—Ç–µ–π
   - Epsilon-greedy –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π

4. **IoTEdgeEnvironment** ‚Äî —Å–∏–º—É–ª—è—Ç–æ—Ä AIoT —Å–∏—Å—Ç–µ–º—ã
   - 25 Edge-—É–∑–ª–æ–≤, 50 IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ü—É–∞—Å—Å–æ–Ω–∞)
   - –û—Ç–∫–∞–∑—ã —É–∑–ª–æ–≤, –≤–∞—Ä—å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏

#### –§—É–Ω–∫—Ü–∏–∏:

- `train_qmix()` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è (1000 —ç–ø–∏–∑–æ–¥–æ–≤)
- `evaluate_scenarios()` ‚Äî –æ—Ü–µ–Ω–∫–∞ –Ω–∞ 4 —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö
- `select_action()` ‚Äî –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è —Å epsilon-greedy
- `update()` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–π

### visualizations.py

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 7 –∫–ª—é—á–µ–≤—ã—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π:

1. **qmix_architecture_diagram.png** ‚Äî –¥–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
2. **simulation_environment.png** ‚Äî –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å 4 –ø–æ–¥–≥—Ä–∞—Ñ–∏–∫–∞–º–∏
3. **verification_monotonicity.png** ‚Äî –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–≤–æ–π—Å—Ç–≤–∞ –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç–∏
4. **scalability_analysis.png** ‚Äî –∞–Ω–∞–ª–∏–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏
5. **overload_resilience.png** ‚Äî —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞–º
6. **environment_sensitivity.png** ‚Äî –∞–Ω–∞–ª–∏–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
7. **learning_curves.png** ‚Äî –∫—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è (4 –º–µ—Ç—Ä–∏–∫–∏)

## üìà –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ | 4.8 —Å–µ–∫ | ‚úì |
| –°–æ–±–ª—é–¥–µ–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–æ–≤ | 87.3% | ‚úì |
| –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å (Jain) | 0.85 | ‚úì |
| –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ | 6.2% | ‚úì |

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

- **–õ–∏–Ω–µ–π–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:** O(k) –¥–ª—è k –∞–≥–µ–Ω—Ç–æ–≤
- **–î–æ 100 —É–∑–ª–æ–≤:** 380 –º—Å –Ω–∞ —Ä–∞—É–Ω–¥
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ vs VCG:** 3.26√ó –Ω–∞ –∫—Ä—É–ø–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

### –°—Ü–µ–Ω–∞—Ä–∏–∏

1. **–°—Ç–∞–±–∏–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞** ‚Äî MRT=4.2s, DCR=91.5%
2. **–ü–∏–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏** ‚Äî MRT=5.3s, DCR=85.2%
3. **–û—Ç–∫–∞–∑—ã —É–∑–ª–æ–≤** ‚Äî MRT=6.7s, DCR=78.1%
4. **–†–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã** ‚Äî MRT=4.9s, DCR=86.7%

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –≤ –∫–æ–¥–µ:

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã QMIX

```python
learning_rate = 1e-3        # –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
gamma = 0.99                # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–∏—Å–∫–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
epsilon_start = 0.1         # –ù–∞—á–∞–ª—å–Ω—ã–π epsilon-greedy
tau = 0.01                  # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç soft update
update_interval = 100       # –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è target —Å–µ—Ç–µ–π
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ä–µ–¥—ã

```python
num_agents = 25             # –ß–∏—Å–ª–æ Edge-—É–∑–ª–æ–≤
num_devices = 50            # –ß–∏—Å–ª–æ IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
episode_length = 500        # –î–ª–∏–Ω–∞ —ç–ø–∏–∑–æ–¥–∞
batch_size = 64             # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
replay_buffer_size = 10000  # –†–∞–∑–º–µ—Ä experience replay –±—É—Ñ–µ—Ä–∞
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è

```python
w_completion = 0.4          # –í–µ—Å: –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á
w_deadline = 0.35           # –í–µ—Å: —Å–æ–±–ª—é–¥–µ–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–æ–≤
w_fairness = 0.15           # –í–µ—Å: —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å
w_energy = 0.1              # –í–µ—Å: —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
```

## üî¨ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –°—Ç–µ–Ω–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –†–∞–∑–º–µ—Ä | –£–∑–ª–æ–≤ | –£—Å—Ç—Ä–æ–π—Å—Ç–≤ | CPU –¥–∏–∞–ø–∞–∑–æ–Ω | Memory –¥–∏–∞–ø–∞–∑–æ–Ω |
|--------|-------|-----------|--------------|-----------------|
| –ú–∞–ª—ã–π | 10 | 20 | 20-40 | 32-64 –ì–ë |
| –°—Ä–µ–¥–Ω–∏–π | 25 | 50 | 20-40 | 32-64 –ì–ë |
| –ë–æ–ª—å—à–æ–π | 50 | 100 | 20-40 | 32-64 –ì–ë |
| XL | 100 | 200 | 20-40 | 32-64 –ì–ë |

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–∞–¥–∞—á

- **CPU —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** 0.1‚Äì8.0 –µ–¥–∏–Ω–∏—Ü
- **Memory —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** 0.1‚Äì16.0 –ì–ë
- **–î–µ–¥–ª–∞–π–Ω—ã:** 0.5‚Äì10.0 —Å–µ–∫—É–Ω–¥
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:** 0.5‚Äì1.0 (—Å–ª—É—á–∞–π–Ω—ã–µ)

## üéØ –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–†–µ–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Raspberry Pi, Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, –∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫
3. **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏
4. **–ì–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —É–∑–ª–æ–≤ (HAPPO)
5. **–ì–∏–±—Ä–∏–¥–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã** ‚Äî —Å–æ—á–µ—Ç–∞–Ω–∏–µ —Å –∞—É–∫—Ü–∏–æ–Ω–Ω—ã–º–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è

## üë§ –ê–≤—Ç–æ—Ä

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –≤ –¥–µ–∫–∞–±—Ä–µ 2025 –≥.

---

**–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:** —Å–º. —Ä–∞–∑–¥–µ–ª "–ö–æ–Ω—Ç–∞–∫—Ç—ã" –≤ –≥–ª–∞–≤–Ω–æ–º –æ—Ç—á—ë—Ç–µ.
